<a name="–†—É—Å—Å–∫–∏–π"></a>

# LLM Book Rewriter

![Alt text](https://imgur.com/a/FT73VWY "–ü—Ä–∏–º–µ—Ä 1")

[Go to English](#english)

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø–æ–º–æ—â–∏ –∞–≤—Ç–æ—Ä–∞–º –∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞–º –≤ –≤—ã—á–∏—Ç–∫–µ –∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–∏–≥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM). –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

*   **–£–ª—É—á—à–∏—Ç—å —Å—Ç–∏–ª—å –∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É:** LLM –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã —É–ª—É—á—à–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏.
*   **–ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç:** –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É, LLM –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, —Å–æ—Ö—Ä–∞–Ω—è—è —Å–º—ã—Å–ª.
*   **–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏:** LLM –º–æ–∂–µ—Ç —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∏–ª–∏ —É—Å–ª–æ–∂–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.

**–í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ:**

*   –í —Å–≤—è–∑–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–æ. *(–í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ç–∏).*
*   –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ —Å—Ç—Ä–∞–Ω –ï–≤—Ä–æ–ø–µ–π—Å–∫–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –∑–æ–Ω—ã (EEA), –®–≤–µ–π—Ü–∞—Ä–∏–∏ –∏–ª–∏ –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏–∏(–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã –ø–æ–¥—Ö–æ–¥—è—Ç), Google –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–≤–æ–µ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π, **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.** –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–∞—à–∏ —Ç–µ–∫—Å—Ç—ã –Ω–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è LLM.

## üîë –ü–æ–ª—É—á–µ–Ω–∏–µ API-–∫–ª—é—á–∞

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º API-–∫–ª—é—á Google AI Studio.  –í–æ—Ç –∫–∞–∫ –µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å:

1.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: [https://aistudio.google.com/apikey](https://aistudio.google.com/apikey)
2.  –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º Google –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∞—à–µ–≥–æ API-–∫–ª—é—á–∞.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1.  –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è API-–∫–ª—é—á–∞, —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `config.json` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç).
2.  –í–Ω–µ—Å–∏—Ç–µ –≤ —Ñ–∞–π–ª `config.json` –≤–∞—à API-–∫–ª—é—á –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
3.  (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ò–∑–º–µ–Ω–∏—Ç–µ chunk_size, –æ–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –µ–¥–∏–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –≤ –º–æ–¥–µ–ª—å. –ù–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è(–æ–∫–æ–ª–æ 1000) —É–ª—É—á—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–æ –≤–µ–¥—É—Ç –∫ —É–≤–µ–ª–∏—á–µ–Ω–∏—é —á–∏—Å–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤(–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç - 1500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å)
4.  (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ò–∑–º–µ–Ω–∏—Ç–µ main_prompt - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –Ω–µ–π—Ä–æ—Å–µ—Ç–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –≤—ã—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç, –Ω–æ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ª—é–±—É—é —Ü–µ–ª—å: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤ –¥—Ä—É–≥–æ–º —Å—Ç–∏–ª–µ, –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ—Ö –∫–æ—Ç–æ–≤ –Ω–∞ —Å–æ–±–∞–∫ –∏ —Ç–æ–º—É –ø–æ–¥–æ–±–Ω–æ–µ

```json
{
    "gemini_api_key": "–°–Æ–î–ê",
    "model_name": "models/gemini-2.0-flash",
    "chunk_size": 8000,
    "output_dir": "output_books",
    "main_prompt": "You are a professional rewriter. Rewrite the following text fragment according to the client's instructions below.\n\nClient's instructions:\n1. Correct any spelling mistakes and typos.\n2. Correct punctuation.\n3. Do not change any names/words you aren't sure about\n4. Do not change anything else."
}
```

## üöÄ –ó–∞–ø—É—Å–∫

*   –ü–æ–ª–æ–∂–∏—Ç–µ –∫–Ω–∏–≥–∏(–ø–æ–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ fb2) –≤ –æ–¥–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –∫–æ–¥–æ–º, –∑–∞–ø—É—Å—Ç–∏—Ç–µ
*   –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –ª–µ–∂–∞—Ç—å –≤ –ø–∞–ø–∫–µ output_books, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–π —Å—Ä–µ–¥–Ω–µ–π –∫–Ω–∏–≥–∏(400–∫ —Å–∏–º–≤–æ–ª–æ–≤) –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ –¥–µ—Å—è—Ç–∏ –º–∏–Ω—É—Ç
*   –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–Ω–æ–≤–æ, –æ—á–∏—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã processed_chunks.txt –∏ processed_chunks_count.txt
---

<a name="english"></a>

# LLM Book Rewriter

[Go to –†—É—Å—Å–∫–∏–π](#—Ä—É—Å—Å–∫–∏–π)

## üìñ Description

This program is designed to assist authors and editors in proofreading and rewriting book texts using large language models (LLM). It allows you to:

*   **Improve style and grammar:** LLM can suggest text improvements and correct spelling and punctuation errors.
*   **Paraphrase text:** If you need to change the wording, LLM can offer alternative options while preserving the meaning.
*   **Adapt the text for different audiences:** LLM can simplify or complicate the text depending on the target audience.

**Important Note:**

*   Due to restrictions, the use of the program in the Russian Federation may be difficult. *(You may need to use alternative methods of connecting to the network).*
*   When making requests from countries in the European Economic Area (EEA), Switzerland, or the United Kingdom, Google, in accordance with its policy, **does not use your data to train models.** This means that your texts will not be used to further improve the LLM.

## üîë Obtaining an API Key

To run the program, you need a Google AI Studio API key. Here's how to get it:

1.  Go to: [https://aistudio.google.com/apikey](https://aistudio.google.com/apikey)
2.  Follow Google's instructions to create and obtain your API key.

## ‚öôÔ∏è Configuration

1.  After obtaining the API key, create a `config.json` file in the root directory of the project (if it doesn't already exist).
2.  Enter your API key into the `config.json` file in the following format:
3.  (Optional) As you can see, in both config.json and main.py prompts are in Russian. From my tests, it can drastically affect output quality, so you should translate it to the language of your book

```json
{
    "gemini_api_key": "abcde1234",
    "model_name": "models/gemini-2.0-flash",
    "chunk_size": 8000,
    "output_dir": "output_books",
    "main_prompt": "You are a professional rewriter. Rewrite the following text fragment according to the client's instructions below.\n\nClient's instructions:\n1. Correct any spelling mistakes and typos.\n2. Correct punctuation.\n3. Do not change any names/words you aren't sure about\n4. Do not change anything else."
}
```

## üöÄ Running

*   Put the books (currently only supports fb2 format) in the same directory as the code, then run it.
*   The output will be in the "output_books" folder. Processing one average book (400k characters) takes about ten minutes.
*   If you want to start processing from scratch, clear the processed_chunks.txt and processed_chunks_count.txt files.
